<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link rel="stylesheet" href="./todo.css">
  </head>
  <body>
    <div id="header">
      
    </div>
    <div id="container">
      <div class="input-title">
        <form id="formTodo"  action="">
          <input placeholder="Tạo ghi chú" type="todo" type="text" />
          <button type="submit">
            <span class="material-symbols-outlined"> add </span>
          </button>
        </form>
      </div>

      <div id="todolist">
        <div class="todo-container"></div>
        <div class="btn-container">
          <button id="btn-clear" type="submit">
            <span class="material-symbols-outlined">delete_sweep </span>
          </button>
        </div>
      </div>
    </div>

    <script>

      var inputEle = document.querySelector("input");
      var formElement = document.querySelector("#formTodo");
      const todoContainer = document.querySelector(".todo-container");

      function addTodo(todoText) {
        const todoItem = document.createElement("div");
        const itemValue = document.createElement("div");
        todoItem.classList.add("todo-item");
        itemValue.classList.add("item");
        itemValue.textContent = todoText;
        todoItem.appendChild(itemValue);
        addRemoveButton(todoItem);
        addCompleteButton(todoItem);
        todoContainer.appendChild(todoItem);
        
        // Add Clear Button
        updateClearButtonVisibility();
        // Lưu danh sách todos vào localStorage
        saveTodosToLocalStorage();
      }


    function updateClearButtonVisibility() {
      const todoItems = document.querySelectorAll(".todo-item");
      const clearBtn = document.querySelector(".btn-container");
      if (todoItems.length > 0) {
        clearBtn.style.display = "block";
        console.log(1223);

      } else {
        clearBtn.style.display = "none";
        console.log(123);
      }
    }
      function addCompleteButton(element) {
        const completeBtn = document.createElement("span");
        completeBtn.textContent = "check_circle";
        completeBtn.classList.add("complete", "material-symbols-outlined");
        element.appendChild(completeBtn);
      }

      function addRemoveButton(element) {
        const removeBtn = document.createElement("span");
        removeBtn.textContent = "delete";
        removeBtn.classList.add("delete", "material-symbols-outlined");
        element.appendChild(removeBtn);

        // Lưu danh sách todos vào localStorage
        saveTodosToLocalStorage();

      }

      function saveTodosToLocalStorage() {
        // Lấy danh sách các mục công việc từ DOM và lưu vào localStorage
        const todos = [];
        const todoItems = document.querySelectorAll(".todo-item");
        todoItems.forEach((item) => {
          const todoText = item.querySelector(".item").textContent;
          todos.push(todoText);
        });
        localStorage.setItem("todos", JSON.stringify(todos));
      }
      
      function loadTodosFromLocalStorage() {
        const todos = JSON.parse(localStorage.getItem("todos"));
        if (todos) {
          todos.forEach((todoText) => {
            addTodo(todoText);
          });
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        // loadTodosFromLocalStorage();
      });

      

      formElement.addEventListener("submit", (e) => {
        e.preventDefault(); // no load page when submit

        // if (!inputEle.value) { // no add null value
        //   return;
        // }

        // debugger;
        addTodo(inputEle.value);

        formElement.reset(); // reset form then submit
      });

      todoContainer.addEventListener("click", (e) => {
        switch (true) {
          case e.target.classList.contains("delete"):
            e.target.parentElement.remove();
            break;
          case e.target.classList.contains("complete"):
            e.target.parentElement.classList.toggle("completed");
            break;
          default:
            break;
        }
        // if (
        //   e.target.tagName === "BUTTON" &&
        //   e.target.classList.contains("remove")
        // ) {
        //   e.target.parentElement.remove();
        // } else if (
        //   e.target.tagName === "BUTTON" &&
        //   e.target.classList.contains("complete")
        // ) {
        //   e.target.parentElement.classList.toggle("complete");
        // }
      });

      const clearBtn = document.getElementById("btn-clear");
      clearBtn.addEventListener("click", () => {
        todoContainer.innerHTML = "";
      });
    </script>
  </body>
</html>
